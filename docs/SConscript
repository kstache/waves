import os
env = Environment(ENV=os.environ.copy())

env.Substfile("conf.py.in", SUBST_DICT={'@PROJECT_NAME@': 'scons-simulation', '@VERSION@': '0.1.1+dev'})

documentation_file_list = [
    'changelog.rst',
    'index.rst',
    'project_brief.txt',
    'references.bib',
    'release_philosophy.rst',
    'targets.txt',
    'model_repository_user.rst',
    'build.txt',
    'documentation.txt',
    'zreferences.rst',
    '_static/custom.css'
]

# TODO: Find the sphinx-build program with scons
# TODO: os agnostic pathsep for the html directory
env.Command(target=['documentation', 'html/index.html'],
            source=documentation_file_list,
            action="sphinx-build -b html ${TARGET.dir.abspath} ${TARGET.dir.abspath}/html")
